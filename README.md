# Personal AI Assistant (Bun + Telegram + Google Suite)

Simplified single-package setup using Bun, Elysia for a lightweight health endpoint, and grammY with long polling.

## Project layout
- `src/` contains all application code (bot, configuration, db helpers).
- `drizzle/` holds SQL migrations generated by Drizzle.

## Prerequisites
- [Bun](https://bun.sh) (latest stable)
- Docker (for Postgres) and docker-compose
- Telegram Bot token
- Google Cloud OAuth credentials (web application)

## Setup
1. Copy environment configuration:
   ```bash
   cp .env.example .env
   ```
2. Start Postgres locally:
   ```bash
   docker-compose up -d db
   ```
3. Install dependencies:
   ```bash
   bun install
   ```
4. Run database migrations (from project root):
   ```bash
   bun run drizzle:migrate
   ```
5. Start the bot (long polling) with a health endpoint on `PORT` (default 3000):
   ```bash
   bun run dev
   ```

## Long polling vs. webhook
- The bot uses grammY long polling for simplicity; no Telegram webhook configuration is required.
- A `/health` endpoint is still exposed via Elysia for monitoring.

## Google Cloud setup
- Create OAuth 2.0 credentials (Web application) and configure the redirect URI to `https://<your-domain>/oauth/callback` (or `http://localhost:3000/oauth/callback` for local testing).
- Populate `GOOGLE_CLIENT_ID`, `GOOGLE_CLIENT_SECRET`, and `GOOGLE_REDIRECT_URI` in your `.env`.

## Local development commands
- **Run app:** `bun run dev`
- **Generate migrations:** `bun run drizzle:generate`
- **Apply migrations:** `bun run drizzle:migrate`
- **Tests:** `bun test`

## Notes
- Google OAuth tokens must be at least 32 characters (see `MASTER_ENCRYPTION_KEY`) and are encrypted at rest using AES-256-GCM.
